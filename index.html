<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>undefined</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        #map {
            height: calc(100vh - 80px);
            width: 100%;
            z-index: 1;
        }
        .status-marker {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            font-weight: bold;
            color: white;
            font-size: 14px;
        }
        .status-empty { background-color: #10b981; }
        .status-crowded { background-color: #f59e0b; }
        .status-full { background-color: #ef4444; }
    </style>
</head>
<body class="bg-gray-50 flex flex-col h-screen overflow-hidden">

    <header class="bg-white shadow-sm p-4 flex justify-between items-center z-10">
        <h1 class="text-lg font-bold text-gray-800">undefined</h1>
        <div class="flex gap-2 text-xs font-medium">
            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-emerald-500"></span>ç©ºã</span>
            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-amber-500"></span>æ··é›‘</span>
            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-red-500"></span>æº€è»Š</span>
        </div>
    </header>

    <main class="flex-grow relative">
        <div id="map"></div>
    </main>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        let map;
        // ãƒ‡ãƒ¼ã‚¿ã®æµã—è¾¼ã¿
        const locations = [{"rowNum":2,"id":1,"name":"ç¬¬ä¸€é§è»Šå ´","lat":35.3613424,"lng":139.4724624,"status":"ç©ºã"},{"rowNum":3,"id":2,"name":"ç¬¬äºŒé§è»Šå ´","lat":35.3607581,"lng":139.4543753,"status":"æº€è»Š"}];
        let points = [];

        window.onload = function() {
            initMap();
        };

        function initMap() {
            map = L.map('map', { zoomControl: false });

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);

            L.control.zoom({ position: 'bottomright' }).addTo(map);

            locations.forEach(loc => {
                addStatusMarker(loc);
                points.push([loc.lat, loc.lng]);
            });

            if (points.length > 0) {
                const bounds = L.latLngBounds(points);
                map.fitBounds(bounds);
            }
        }

        function addStatusMarker(loc) {
            let statusClass = 'status-empty';
            let statusLabel = loc.status;
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¤å®šï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å€¤ã«åˆã‚ã›ã‚‹ï¼‰
            if (loc.status === 'ç©ºã' || loc.status === 'ç©º') statusClass = 'status-empty';
            else if (loc.status === 'æ··é›‘' || loc.status === 'æ··') statusClass = 'status-crowded';
            else if (loc.status === 'æº€è»Š' || loc.status === 'æº€') statusClass = 'status-full';

            const customIcon = L.divIcon({
                className: 'status-marker ' + statusClass,
                html: '<span>' + statusLabel.substring(0,1) + '</span>',
                iconSize: [36, 36],
                iconAnchor: [18, 18]
            });

            const marker = L.marker([loc.lat, loc.lng], { icon: customIcon }).addTo(map);

            const popupContent = `
                <div class="p-1">
                    <h3 class="font-bold text-gray-800">${loc.name}</h3>
                    <p class="text-sm">çŠ¶æ³: ${loc.status}</p>
                    <a href="https://www.google.com/maps/dir/?api=1&destination=${loc.lat},${loc.lng}" 
                       target="_blank" class="text-blue-500 text-xs mt-2 block">ğŸš— ãƒ«ãƒ¼ãƒˆæ¡ˆå†…</a>
                </div>
            `;
            marker.bindPopup(popupContent);
        }
    </script>
</body>
</html>